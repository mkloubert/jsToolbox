// LICENSE: LGPL 3 - https://www.gnu.org/licenses/lgpl-3.0.txt

// s. https://github.com/mkloubert/jsToolbox

Array.prototype.isEmpty=function(){return this.length<1};Array.prototype.isNotEmpty=function(){return!this.isEmpty()};Number.prototype.padLeft=function(e,t){if(typeof t=="undefined"){t="0"}return this.toString().padLeft(e,t)};String.prototype.endsWith=function(e){return this.indexOf(e,this.length-e.length)>-1};String.prototype.format=function(){return this.formatArray(arguments)};String.prototype.formatArray=function(e){if(!e){e=[]}return this.replace(/{(\d+)}/g,function(t,n){return typeof e[n]!="undefined"?e[n]:t})};String.prototype.isEmpty=function(){return this.length<1};String.prototype.isNotEmpty=function(){return!this.isEmpty()};String.isNullOrWhitespace=function(e){return e==null||e.isWhitespace()};String.prototype.isWhitespace=function(){return this.trim().isEmpty()};String.prototype.padLeft=function(e,t){if(typeof e=="undefined"){e=0}if(typeof t=="undefined"){t=" "}var n=this;if(e+1>=n.length){n=Array(e+1-n.length).join(t)+n}return n};String.prototype.startsWith=function(e){return 0==this.indexOf(e)};if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}if(!String.prototype.trimLeft){String.prototype.trimLeft=function(){return this.replace(/^\s+/,"")}}if(!String.prototype.trimRight){String.prototype.trimRight=function(){return this.replace(/\s+$/,"")}}String.prototype.ucwords=function(){var e=this.toLowerCase();return e.replace(/(^([a-zA-Z\p{M}]))|([ -][a-zA-Z\p{M}])/g,function(e){return e.toUpperCase()})};var jsToolboxMJK={};(function($jsTB){Object.defineProperty($jsTB,"$",{get:function(){return this.jQuery}});Object.defineProperty($jsTB,"body",{get:function(){return this.jQuery("body")}});Object.defineProperty($jsTB,"head",{get:function(){return this.jQuery("head")}});Object.defineProperty($jsTB,"jQuery",{get:function(){return window.jQuery}});Object.defineProperty($jsTB,"noop",{get:function(){return this.jQuery.noop}});Object.defineProperty($jsTB,"now",{get:function(){return new Date}});Object.defineProperty($jsTB,"nowUTC",{get:function(){var e=this.now;return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}});$jsTB.events={};{$jsTB.events.pageLoaded=function(e,t){var n={};var r=null;var i=null;for(var s=0;s<$jsTB.page.__onPageLoadedActions.length;s++){var o=$jsTB.page.__onPageLoadedActions[s];var u=o.action;var a=o.state;var f=o.options;var l={continueOnError:f.continueOnError,index:s,lastErr:r,prevState:i,nextState:null,state:a,vars:n};Object.defineProperty(l,"isFirst",{get:function(){return this.index==0}});Object.defineProperty(l,"isLast",{get:function(){return this.index+1==$jsTB.page.__onPageLoadedActions.length}});r=null;try{if(u){u($jsTB,l)}}catch(c){r=c;l.error=c;if(f.error){if(null==l.continueOnError){l.continueOnError=true}f.error($jsTB,l)}else{if(null==l.continueOnError){l.continueOnError=false}}if(!f.continueOnError){throw c}}finally{if(f.complete){f.complete($jsTB,l)}}i=l.nextState}}}$jsTB.funcs={};{$jsTB.funcs.asFunc=function(e){var t=e;if(!this.isFunc(t)){t=function(){return e}}return t};$jsTB.funcs.asJQuery=function(e){if(!this.isJQuery(e)){e=$jsTB.jQuery(e)}return e};$jsTB.funcs.buildBatch=function(e){e=$jsTB.jQuery.extend({stopOnFirstError:true},e);var t=[];var n={};n.add=function(e){var t={args:[],func:e};for(var n=1;n<arguments.length;n++){t.args.push(arguments[n])}return this};n.clear=function(){t=[];return this};n.__getItem=function(e){return t[e]};n.invoke=function(t){t=$jsTB.jQuery.extend({stopOnFirstError:e.stopOnFirstError?true:false},t);var n=[];for(var r=0;r<this.length;r++){var i=this.__getItem(r);var s=$jsTB.funcs.invokeArray(i.func,i.args);n.push(s);if(s.hasFailed){if(t.stopOnFirstError){break}}}return n};Object.defineProperty(n,"length",{get:function(){return t.length}});return n};$jsTB.funcs.eval=function(e){return $jsTB.jQuery.globalEval(e)};$jsTB.funcs.invoke=function(e){var t=[];for(var n=1;n<arguments.length;n++){t.push(arguments[n])}return this.invokeArray(e,t)};$jsTB.funcs.invokeArray=function(fn,args){if(!args){args=[]}var result={args:args,hasBeenInvoked:false};Object.defineProperty(result,"duration",{get:function(){if(!this.startTime||!this.endTime){return}return this.endTime-this.startTime}});Object.defineProperty(result,"hasFailed",{get:function(){return this.error?true:false}});try{if(fn){result.hasBeenInvoked=true;var code="fn(";for(var i=0;i<result.args.length;i++){if(i>0){code+=","}code+="result.args[{0}]".format(i)}code+=");";result.startTime=$jsTB.now;result.result=eval(code);result.endTime=$jsTB.now}}catch(e){result.endTime=$jsTB.now;result.error=e}return result};$jsTB.funcs.isArray=function(e){return $jsTB.jQuery.isArray(e)};$jsTB.funcs.isFunc=function(e){return $jsTB.jQuery.isFunction(e)};$jsTB.funcs.isJQuery=function(e){return e instanceof jQuery};$jsTB.funcs.isString=function(e){return typeof e=="string"||e instanceof String};$jsTB.funcs.registerForFileUpload=function(e,t){t=$jsTB.jQuery.extend({},t);e=this.asJQuery(e);var n;e.find("input[type=file]").on("change",function(r){var i=$jsTB.jQuery(this);n=[];$jsTB.jQuery.each(r.target.files,function(e,t){var r={file:t,name:i.attr("name")};if(typeof r.name==="undefined"){r.name=e}n.push(r)});if(t.change){var s={files:n,options:t,submit:function(){e.submit()}};t.change(s)}}).trigger("change");e.on("submit",function(r){r.stopPropagation();r.preventDefault();var i=new FormData;$jsTB.jQuery.each(n,function(e,t){i.append(t.name,t.file)});e.find("input").not("input[type=file]").not("input[type=submit]").not("input[type=button]").not("input[type=image]").each(function(e,t){var n=$jsTB.jQuery(t);var r=n.attr("name");if(typeof r==="undefined"){r=e}i.append(r,n.val())});var s={cancel:false,data:i,form:e,options:t};if(t.beforeSubmit){t.beforeSubmit(s)}if(s.cancel){return}if(typeof s.options.action==="undefined"){s.options.action=e.attr("action")}if(typeof s.options.method==="undefined"){s.options.method=e.attr("method")}if(!s.options.method){s.options.method="POST"}$jsTB.jQuery.ajax({cache:false,contentType:false,data:i,processData:false,type:s.options.method,url:s.options.action,complete:function(t,n){if(!s.options.complete){return}s.options.complete({form:e,status:n,xhr:t})},error:function(t,n,r){if(!s.options.error){return}s.options.error({error:r,form:e,status:n,xhr:t})},success:function(t,n,r){if(!s.options.success){return}s.options.success({data:t,form:e,status:n,xhr:r})},xhr:function(){var t=$jsTB.jQuery.ajaxSettings.xhr();t.upload.onprogress=function(n){if(!s.options.progress){return}var r={form:e,total:n.total,uploaded:n.loaded,xhr:t};Object.defineProperty(r,"percentage",{get:function(){return this.progress*100}});Object.defineProperty(r,"progress",{get:function(){if(0!=this.total){return this.uploaded/this.total}return 0}});Object.defineProperty(r,"remaining",{get:function(){return this.total-this.uploaded}});s.options.progress(r)};return t}})});return e};$jsTB.funcs.toStringSafe=function(e){var t=e;if(!t){t=""}if(!this.isString(t)){t=t.toString();if(!t){t=""}}return t};$jsTB.funcs.trim=function(e){return this.toStringSafe(e).trim()};$jsTB.funcs.trimLeft=function(e){return this.toStringSafe(e).trimLeft()};$jsTB.funcs.trimRight=function(e){return this.toStringSafe(e).trimRight()};$jsTB.funcs.waitForPage=function(e,t,n){n=$jsTB.jQuery.extend({waitUntilRetry:500},n);if(!t){t=null}if(!$jsTB.page.context){setTimeout(function(){$jsTB.funcs.waitForPage(e,t,n)},n.waitUntilRetry);return}e($jsTB,t)}}$jsTB.page={};{$jsTB.page.__onPageLoadedActions=[];$jsTB.page.addElement=function(e,t,n){n=$jsTB.jQuery.extend({target:this.elements},n);t=$jsTB.funcs.asJQuery(t);Object.defineProperty(n.target,$jsTB.jQuery.trim(e),{get:$jsTB.funcs.asFunc(t)});return this};$jsTB.page.addOnLoaded=function(e,t,n){n=$jsTB.jQuery.extend({continueOnError:null},n);if(!t){t=null}$jsTB.page.__onPageLoadedActions.push({action:e,options:n,state:t});return this};$jsTB.page.addVar=function(e,t,n){n=$jsTB.jQuery.extend({target:this.vars},n);Object.defineProperty(n.target,$jsTB.jQuery.trim(e),{get:$jsTB.funcs.asFunc(t)});return this};$jsTB.page.elements={};$jsTB.page.funcs={};$jsTB.page.lang={};$jsTB.page.request={};{$jsTB.page.request.GET={};document.location.search.replace(/\??(?:([^=]+)=([^&]*)&?)/g,function(e,t,n){var r=function(e){return decodeURIComponent(e.split("+").join(" "))};$jsTB.page.request.GET[r(t)]=r(n)})}$jsTB.page.vars={}}$jsTB.jQuery(document).ready(function(){var e={};$jsTB.page.context=e;if($jsTB.events.pageLoaded){var t={};$jsTB.events.pageLoaded($jsTB,t)}})})(jsToolboxMJK);if(typeof $jsTB==="undefined"){$jsTB=jsToolboxMJK}